# 프론트엔드 개발 히스토리

## 1. 프로젝트 초기 세팅
- React 기반 프론트엔드 프로젝트 생성 (create-react-app)
- src/frontend/src/components 디렉토리 구조 정립
- 기본 App.js 구조 정리 및 React 로고/템플릿 제거

## 2. 입력 기능(문제 입력) 1차 구현
- TextInput 컴포넌트로 텍스트 입력 기능 구현
- PdfUpload, ImageUpload 컴포넌트로 PDF/이미지 업로드 기능 구현
- 입력값/파일을 콘솔에 출력하는 방식으로 1차 동작 확인

## 3. 채팅 기반 UI로 구조 전환
- 좌측: 대화 내역(리스트), 우측: 채팅창, 하단: 입력창의 3분할 레이아웃 설계
- ChatSidebar(대화 리스트), ChatWindow(채팅 내역), ChatInput(입력창/파일첨부) 컴포넌트 분리
- App.js에서 전체 상태(대화, 메시지, 입력값, 첨부파일 등) 관리
- 채팅 입력, 대화 선택, 파일 첨부, 새 대화 추가 등 기본 동작 구현

## 4. UI/UX 개선 및 기능 확장
- 채팅 입력창 위에 첨부된 파일명 리스트 표시
- 대화 내역(좌측)에서 대화 이름 더블클릭 → 인풋박스 수정 기능 추가
- 대화 이름 옆 ⋮(더보기) 아이콘 추가, 클릭 시 "이름 변경", "삭제" 메뉴 표시
- "이름 변경" 선택 시 인풋박스, "삭제" 선택 시 대화 삭제 기능 구현
- 앱 최초 진입 시 자동으로 "새 대화" 1개 생성 및 선택되도록 개선

## 5. 입력 통합 핸들러 구현
- 텍스트, PDF, 이미지 등 모든 입력을 하나의 통합 핸들러(handleUnifiedInput)에서 처리
- type(텍스트/이미지/PDF/혼합) 자동 판별 및 메시지 객체 구조 통일
- 메시지 배열에 일관된 구조로 저장, 향후 백엔드 연동 및 확장성 확보

## 6. 시행착오 및 개선점
- PDF 미리보기 기능 도입 시 pdfjs-dist 버전/워커 파일 경로 문제로 여러 시행착오 발생 → 최종적으로 미리보기 기능은 제외
- node_modules 경로, public 폴더 파일 복사 등 환경별 경로 이슈 경험
- UI/UX는 Gemini(구글 챗) 스타일을 참고하여 점진적으로 개선

## 7. 현재 상태
- 채팅 기반 문제 입력 UI 완성 (텍스트, PDF, 이미지 첨부 지원)
- 대화 내역 관리, 대화 이름 변경/삭제, 파일 첨부, 입력 통합 처리 등 주요 기능 구현 완료
- 향후 백엔드 연동, 메시지 타입별 처리, 보안/유효성 검사 등 추가 개발 예정

## 8. 입력 통합 및 보안 기능 강화
- 입력 통합 핸들러(handleUnifiedInput)에서 텍스트, PDF, 이미지 입력을 모두 일관되게 처리하도록 테스트 및 리팩터링
- 첨부파일이 PDF/이미지 파일이 아닐 경우 경고 메시지 표출(프론트엔드에서 즉시 안내)
- 텍스트 입력에 스크립트/특수문자 등 악성 입력 시 화면에 노출되지 않도록 처리
- 파일 확장자, MIME 타입, 용량 등 기본 검증 로직 추가
- 다양한 입력/예외 상황(빈 입력, 잘못된 파일, 여러 파일 동시 첨부 등) 테스트 완료
- 모든 입력이 정상적으로 메시지 배열에 저장되고, UI에 잘 표시되는 것 확인
- dev_history.md에 테스트 및 개선 내역 기록

## 9. 클라이언트 사이드 PDF 처리 및 디버깅 기능 추가
- `pdfjs-dist` 라이브러리를 사용하여 브라우저에서 직접 PDF 파일의 텍스트를 추출하는 기능 추가.
- 기존 파일 업로드 로직을 변경하여, 파일 자체를 서버로 보내는 대신 추출된 텍스트를 사용자 메시지와 함께 백엔드 `/run` 엔드포인트로 전송.
- 이를 통해 백엔드 API 변경 없이 PDF 파일 내용을 처리할 수 있게 되어 구조를 단순화함.
- 디버깅을 위해 `console.log`를 추가하여 PDF 파일 처리 시작, 추출된 텍스트의 길이와 일부 내용을 확인하는 로직 포함.

## 10. PDF.js 워커 파일 로딩 오류 해결 및 로컬 파일 방식 전환
- PDF 첨부 시 "Failed to fetch dynamically imported module" 오류 발생 → PDF.js 워커 파일 로딩 실패가 원인으로 판명.
- 기존 CDN 방식(cdnjs.cloudflare.com)에서 발생하는 외부 의존성 문제를 해결하기 위해 로컬 파일 방식으로 전환.
- `node_modules/pdfjs-dist/build/pdf.worker.min.mjs` 파일을 `public/pdf.worker.min.js`로 복사하여 웹서버에서 정적 파일로 서빙.
- App.js의 `pdfjsLib.GlobalWorkerOptions.workerSrc` 설정을 `/pdf.worker.min.js` 로컬 경로로 변경.
- 이를 통해 외부 CDN 의존성 제거, 성능 향상, 보안 강화, 네트워크 환경에 관계없는 안정적 PDF 처리 구현. 